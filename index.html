<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>å¯¹è´¦æ€»ç»“åŠ©æ‰‹</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f8;
      padding: 40px;
      max-width: 700px;
      margin: auto;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    p.description {
      text-align: center;
      color: #666;
      font-size: 14px;
      margin-bottom: 30px;
    }
    form {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-bottom: 20px;
      font-weight: bold;
      color: #333;
    }
    input[type="file"],
    input[type="text"] {
      display: block;
      margin-top: 8px;
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    button {
      margin-top: 20px;
      padding: 12px 20px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      width: 100%;
    }
    button:hover {
      background-color: #45a049;
    }
    .success-message {
      display: none;
      background: #dff0d8;
      color: #3c763d;
      padding: 15px;
      border-radius: 4px;
      margin-top: 20px;
      text-align: left;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 13px;
    }
    pre {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 6px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>ğŸ“Š å¯¹è´¦æ€»ç»“åŠ©æ‰‹</h1>
  <p class="description">è¯·ä¸Šä¼ æ‰€æœ‰è´¦å•ï¼ŒåŠ©æ‰‹å°†è‡ªåŠ¨æ±‡æ€»å¹¶å°†å¯¹è´¦è¡¨ä»¥ Excel æ ¼å¼å‘é€åˆ°æ‚¨çš„é‚®ç®±ğŸ“¬</p>

  <form id="accountingForm">
    <label>ğŸ“ å°è´¦æ–‡ä»¶ï¼ˆä»…é™ä¸€ä¸ªï¼‰ï¼š<input type="file" name="main" accept=".xlsx" required></label>
    <label>ğŸš— æ»´æ»´è´¦å•ï¼ˆä»…é™ä¸€ä¸ªï¼‰ï¼š<input type="file" name="didi" accept=".xlsx" required></label>
    <label>ğŸ” ç¾å›¢è´¦å•ï¼ˆæŒ‰ä½ Shift å¯å¤šé€‰ï¼‰ï¼š<input type="file" name="meituan" accept=".xlsx" multiple required></label>
    <label>ğŸ“§ æ”¶ä»¶é‚®ç®±åœ°å€ï¼ˆå¤šä¸ªé‚®ç®±è¯·ç”¨è‹±æ–‡é€—å· ","åˆ†éš”ï¼‰ï¼š<input type="text" name="email" placeholder="ä¾‹å¦‚ï¼ša@example.com, b@example.com" pattern="^([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\\s*,\\s*)*([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})$" required></label>
    
    <button type="submit">ğŸ“¨ æäº¤è´¦å•</button>
    <div id="successMessage" class="success-message"></div>
  </form>

  <div class="logic-box">
    <h3>ğŸ“Œ æ•°æ®å¤„ç†é€»è¾‘è¯´æ˜</h3>
    <p><strong>å°è´¦æ–‡ä»¶</strong>ï¼šå–ç¬¬ä¸€ä¸ªsheet,æå–å­—æ®µã€Œå§“åã€ã€ã€Œå…¬å¸åˆ«ã€ã€ã€Œ(æœºç¥¨/ç«è½¦ç¥¨)ç¾å›¢202611ã€ã€ã€Œ(ä½å®¿è´¹)ç¾å›¢202611ã€ã€ã€Œ(äº¤é€šè´¹)æ»´æ»´202754ã€å¹¶è®¡ç®—å¯¹åº”ç¥¨æ¬¾ã€ä½å®¿è´¹ã€æ»´æ»´é‡‘é¢ã€‚</p>
    <p><strong>æ»´æ»´è´¦å•</strong>ï¼šä»…ç»Ÿè®¡ã€Œç”¨è½¦åˆ¶åº¦ã€ä¸º"å·®æ—…æ‰“è½¦"ç±»å‹çš„ã€Œä¸‹å•äººå§“åã€ä¸ã€Œå®é™…è½¦è´¹é‡‘é¢ã€ï¼ŒæŒ‰äººåæ±‡æ€»ã€‚</p>
    <p><strong>ç¾å›¢è´¦å•</strong>ï¼šä»ã€Œå›½å†…æœºç¥¨ã€ã€ã€Œç«è½¦ç¥¨ã€ã€ã€Œé…’åº—ã€ä¸‰ä¸ª sheet ä¸­åˆ†åˆ«æå–ä¹˜æœºäººã€ä¹˜è½¦äººã€å…¥ä½äººåŠå…¶ã€Œè®¢å•å®ä»˜é‡‘é¢ï¼ˆä¼ä¸šï¼‰ã€å­—æ®µï¼Œå…¬å¸ç¼–ç åŒ¹é…é€»è¾‘å¦‚ä¸‹ï¼š</p>
    <table border="1" cellpadding="5" cellspacing="0">
      <tr><th>å…¬å¸åç§°åŒ…å«</th><th>åˆ†å…¬å¸ç¼–ç </th></tr>
      <tr><td>ç»å¼€</td><td>æ­¦æ±‰ç»å¼€ â†’ 165G</td></tr>
      <tr><td>å¤§è¿ + æˆéƒ½</td><td>å¤§è¿æˆéƒ½ â†’ 16DC</td></tr>
      <tr><td>å¤§è¿ + åŒ—äº¬</td><td>å¤§è¿åŒ—äº¬ â†’ 16DA</td></tr>
      <tr><td>åŒ—äº¬</td><td>æ­¦æ±‰åŒ—äº¬ â†’ 165A</td></tr>
      <tr><td>å¹¿å·</td><td>æ­¦æ±‰å¹¿å· â†’ 165M</td></tr>
      <tr><td>æ·±åœ³</td><td>æ­¦æ±‰æ·±åœ³ â†’ 165R</td></tr>
      <tr><td>å…¶ä»–æƒ…å†µ</td><td>æ­¦æ±‰ â†’ 1650</td></tr>
    </table>
    <p><strong>è¾“å‡ºæ ¼å¼</strong>ï¼šè¾“å‡ºä¸º report.xlsx æ¡£æ¡ˆï¼Œæ¯ä¸ª sheet ä»¥å¯¹åº”åˆ†å…¬å¸å·å‘½ååˆ†éš”ï¼ˆå¦‚ 165Gã€16DC)ã€‚è¡¨æ ¼ä¸­çš„å·®å¼‚æ•°å€¼å‡æŒ‰ è´¦å•é‡‘é¢ - å°è´¦é‡‘é¢ è®¡ç®—ã€‚å·®å¼‚åŸå› ä¼šå¤‡æ³¨è‹¥æœ‰ä¸€åå‘˜å·¥,å…¬å·ä»…ä¸ç¾å›¢/æ»´æ»´è´¦å•æˆ–å°è´¦ä¸Šå‡ºç°</p>
  </div>

  <script>
    document.getElementById('accountingForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const successMessage = document.getElementById('successMessage');
      const submitButton = e.target.querySelector('button');
      submitButton.disabled = true;
      submitButton.textContent = 'ğŸ“¨ æ­£åœ¨æäº¤...';

      try {
        const formData = new FormData(this);
        const response = await fetch('http://10.6.2.174:5678/webhook/c3fdbc2c-31cc-4fd5-94e6-e6aa6c0a7edb', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();
        const formatted = JSON.stringify(result, null, 2);

        successMessage.innerHTML = `
          <strong>ğŸ“¬ é‚®ä»¶å·²å‘é€ï¼ŒæœåŠ¡å™¨è¿”å›ä»¥ä¸‹ä¿¡æ¯ï¼š</strong>
          <pre>${formatted}</pre>
        `;
        successMessage.style.display = 'block';
        successMessage.style.backgroundColor = '#dff0d8';
        successMessage.style.color = '#3c763d';

      } catch (error) {
        successMessage.textContent = 'æäº¤æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•';
        successMessage.style.display = 'block';
        successMessage.style.backgroundColor = '#f8d7da';
        successMessage.style.color = '#721c24';
      }
    });
  </script>
</body>
</html>